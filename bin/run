#!/usr/bin/env node

const path = require('path')
const project = path.join(__dirname, '..', 'tsconfig.json')
const dev = require('fs').existsSync(project)

if (dev) {
  require('ts-node').register({project})
}

// For single-command CLI, run the command directly
const { Config } = require('@oclif/core')
const Command = require(`../${dev ? 'src' : 'lib'}`)

Config.load().then(async (config) => {
  const cmd = new Command(process.argv.slice(2), config)
  return cmd.run()
}).then(require('@oclif/core/flush')).catch(require('@oclif/core/handle'))
